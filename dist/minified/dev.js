(()=>{function T(t){return typeof t=="function"}function d(t){return T(t)?new s(t):new p(t)}var c=class{constructor(e){this._value=e}watchers=[];activeWatchers=new WeakSet;get(){return l?.(this),this._value}_set(e){let{_value:r}=this;if(e!==this._value){this._value=e;try{for(let n of this.watchers){if(this.activeWatchers.has(n)){console.warn("smork: watcher is already active \u2014 perhaps a circular dependency \u2014 exiting watch to prevent infinite loop");return}this.activeWatchers.add(n),n(e,r)}}finally{this.activeWatchers=new WeakSet}}}runAndWatch(e){e(this._value,this._value),this.watch(e)}watchImmediate=this.runAndWatch;watch(e){this.watchers.push(e)}onChange=this.watch;unwatch(e){this.watchers=this.watchers.filter(r=>r!==e)}get value(){return this.get()}computedGetter(e){return()=>e(this.get())}compute(e){return new s(this.computedGetter(e))}use(e){return new s(this.computedGetter(e),[this])}},p=class extends c{set=super._set;set value(e){this.set(e)}get value(){return this.get()}},l,s=class extends c{constructor(r,n=[]){var e=(...B)=>(super(...B),this.getter=r,this.dependencies=n,this);if(n.length)e(r());else{if(l)throw new Error("smork: currentComputedPreHandler is already set (this should never happen)");try{l=a=>{n.push(a)},e(r())}finally{l=void 0}}this.dependencies.forEach(a=>{a.watch(()=>this.refresh())})}refresh(){this._set(this.getter())}};function f(t){return new s(t)}function m(t){return f(()=>!t.value)}var g=["html","head","style","script","body","div","h3","p","a","img","audio","input","label","button"],{html:S,head:U,style:k,script:W,body:I,div:R,h3:_,p:F,a:O,img:j,audio:A,input:M,label:D,button:N}=E(g);function E(t){return t.reduce((e,r)=>Object.assign(e,{[r]:v(r)}),{})}function v(t){function e(n,a){let[o,i]=Array.isArray(n)?[void 0,n]:[n,a];return r(o,i)}function r(n,a){let o=document.createElement(t);if(n){let i=function(u){Object.assign(o,u),u.class&&(o.className=u.class),o instanceof HTMLLabelElement&&u.for&&(o.htmlFor=u.for),Object.entries(u.style??{}).forEach(([x,y])=>{o.style[x]=y})};typeof n=="function"?f(n).runAndWatch(i):i(n)}return a&&a.forEach(i=>{typeof i=="string"?o.appendChild(document.createTextNode(i)):o.appendChild(i)}),o}return e}function h(t,e){Object.assign(t,e)}h(window,{ref:d,computed:f,useNot:m,BaseRef:c,Ref:p,ComputedRef:s});})();
