(()=>{function f(e,n){Object.assign(e,n)}function g(e){throw new Error(e)}async function w(e){let t=await(await fetch(e)).blob();return new Promise((r,a)=>{let o=new Image;o.onload=()=>{URL.revokeObjectURL(o.src),r(o)},o.onerror=a,o.src=URL.createObjectURL(t)})}async function p(e,n){let t=await w(e),r=await w(n),a=document.createElement("canvas");a.width=t.width,a.height=t.height;let o=a.getContext("2d")??g("Canvas 2D context not supported");o.drawImage(t,0,0);let x=o.getImageData(0,0,t.width,t.height);o.drawImage(r,0,0);let b=o.getImageData(0,0,r.width,r.height),l=x.data,h=b.data,d=l.length,m=0;for(let s=0;s<d;s+=4)for(let i=0;i<3;i++)m+=Math.abs(l[s+i]-h[s+i]);let y=m/(d/4);return a.remove(),y<32;}var D="vovas",u="sunoTools",I=new Promise((e,n)=>{let t=indexedDB.open(D,1);t.onupgradeneeded=()=>t.result.createObjectStore(u),t.onsuccess=()=>e(t.result),t.onerror=()=>n(t.error)});async function T(e){return(await I).transaction(u,e)}async function v(e){return(await T(e)).objectStore(u)}var c=class{constructor(n,t){this.key=n;this.init=t}async load(){let n=(await v("readonly")).get(this.key);return new Promise((t,r)=>{n.onsuccess=()=>t(n.result??this.init),n.onerror=()=>r(n.error)})}async save(n){let t=await T("readwrite");return t.objectStore(u).put(n,this.key),new Promise((r,a)=>{t.oncomplete=()=>r(),t.onerror=()=>a(t.error)})}};f(window,{areImagesEqual:p,Storage:c});})();
